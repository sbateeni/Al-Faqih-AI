from ..base_madhhab import BaseMadhhab

class MalikiMadhhab(BaseMadhhab):
    """المذهب المالكي - The Maliki School of Islamic Jurisprudence"""
    
    def __init__(self):
        super().__init__()
        self.name = "Maliki"
        self.arabic_name = "المالكي"
        self.founder = "الإمام مالك بن أنس"
        self.founding_period = "القرن الثامن الميلادي (93-179 هـ)"
        self.main_sources = [
            "القرآن الكريم",
            "السنة النبوية",
            "الإجماع", 
            "عمل أهل المدينة",
            "القياس",
            "المصالح المرسلة",
            "سد الذرائع"
        ]
        self.methodology = "الاعتماد على عمل أهل المدينة والمصالح المرسلة"
        self.geographic_influence = [
            "المغرب",
            "الجزائر",
            "تونس",
            "ليبيا",
            "موريتانيا",
            "السنغال",
            "مالي",
            "أجزاء من مصر والسودان"
        ]
        self.famous_scholars = [
            "الإمام مالك بن أنس",
            "الإمام ابن القاسم",
            "الإمام أشهب", 
            "الإمام سحنون",
            "الإمام ابن عبد البر",
            "الإمام القرافي",
            "الإمام الشاطبي"
        ]
    
    def get_introduction(self) -> str:
        """مقدمة عن المذهب المالكي"""
        return f"""أنا المذهب {self.arabic_name}، مذهب أهل المدينة النبوية المباركة.
        
        تأسست على يد إمام دار الهجرة {self.founder} في {self.founding_period}.
        
        أتميز باعتمادي على عمل أهل المدينة المنورة، فهم أعلم الناس بما كان عليه 
        النبي صلى الله عليه وسلم وصحابته الكرام من العمل والتطبيق.
        
        كما أشتهر بمراعاتي للمصالح المرسلة وسد الذرائع، مما يجعلني مذهباً عملياً
        يراعي الواقع ومصالح الناس.
        
        أنتشر بقوة في {', '.join(self.geographic_influence[:4])} وجميع بلدان شمال وغرب أفريقيا."""
    
    def get_methodology(self) -> str:
        """منهجية المذهب المالكي"""
        return """منهجيتي في الاستنباط تقوم على:
        
        1. القرآن الكريم - المصدر الأساسي
        2. السنة النبوية - مع التركيز على الأحاديث المشهورة
        3. الإجماع - خاصة إجماع أهل المدينة
        4. عمل أهل المدينة - العمل المتواتر في المدينة المنورة
        5. القياس - مع الحذر في استخدامه
        6. المصالح المرسلة - المصالح غير المنصوص عليها
        7. سد الذرائع - منع الوسائل المؤدية للحرام
        
        أركز على الجانب العملي والواقعي في الأحكام الفقهية."""
    
    def get_famous_scholars(self) -> str:
        """علماء المذهب المالكي المشهورون"""
        return f"""من أبرز علمائي:
        
        • {self.famous_scholars[0]} - إمام دار الهجرة ومؤسس المذهب
        • {self.famous_scholars[1]} - أشهر تلاميذ الإمام مالك
        • {self.famous_scholars[2]} - من كبار تلاميذ مالك ورواة المذهب
        • {self.famous_scholars[3]} - صاحب المدونة الكبرى في الفقه المالكي
        • {self.famous_scholars[4]} - الحافظ صاحب التمهيد والاستذكار
        • {self.famous_scholars[5]} - صاحب الفروق المشهورة
        • {self.famous_scholars[6]} - صاحب الموافقات في أصول الشريعة"""
    
    def build_prompt(self, question: str) -> str:
        """بناء التوجيه المخصص للمذهب المالكي"""
        base_prompt = super().build_prompt(question)
        
        maliki_additions = f"""
        
        معلومات إضافية عن المذهب المالكي:
        - أعتمد بشدة على عمل أهل المدينة كمصدر تشريعي مهم
        - أولي أهمية كبيرة للمصالح المرسلة وسد الذرائع
        - أركز على الجانب العملي والواقعي في التطبيق
        - أشتهر بمحافظتي على تقاليد المدينة النبوية
        
        تأكد من إبراز هذه الخصائص وكيف تؤثر على الحكم الفقهي المالكي."""
        
        return base_prompt + maliki_additions